{
  "service": {
    "specVersion": "v3",
    "catalog_metadata": {
      "name": "CAMLAB3_7 Service",
      "description": "A service to deploy a single VM with selectable T-Shirt size resources",
      "image": "serviceicon_1.svg",
      "category": "CAMLab",
      "bullets": [],
      "providerDisplayName": "IBM",
      "longDescription": "",
      "documentationUrl": "",
      "supportUrl": "",
      "bindable": false,
      "updatable": "",
      "systemTags": true,
      "author": "admin"
    },
    "tags": [
      {
        "name": "Request_Group",
        "label": "Request_Group",
        "type": "string",
        "immutable": true,
        "hidden": false,
        "required": false,
        "secured": false,
        "description": "The current context group id of the current user that requested the provisioning of the template. This is important because a user may be part of more than one group and this identifies the context of which group the user made the request.",
        "isSystemTag": true,
        "default": "${svc_instance.group}",
        "customtype": "string",
        "permission": "Read-Only"
      },
      {
        "name": "Request_User",
        "label": "Request_User",
        "type": "string",
        "immutable": true,
        "hidden": false,
        "required": false,
        "secured": false,
        "description": "The user id of the current user that requested the provisioning of the template.",
        "isSystemTag": true,
        "default": "${svc_instance.owner}",
        "customtype": "string",
        "permission": "Read-Only"
      },
      {
        "name": "Service_Name",
        "label": "Service_Name",
        "type": "string",
        "immutable": true,
        "hidden": false,
        "required": false,
        "secured": false,
        "description": "Name provided for the service instance by the end user at time of request",
        "isSystemTag": true,
        "default": "${svc_instance.name}",
        "customtype": "string",
        "permission": "Read-Only"
      },
      {
        "name": "Service_Identifier",
        "label": "Service_Identifier",
        "type": "string",
        "immutable": true,
        "hidden": false,
        "required": false,
        "secured": false,
        "description": "Unique identifer generated by ICAM which is mapped to the service instance of the template provisioned.",
        "isSystemTag": true,
        "default": "${svc_instance.service_instance_id}",
        "customtype": "string",
        "permission": "Read-Only"
      }
    ],
    "actions": [
      {
        "type": "provision",
        "name": "Provision",
        "description": "Default action for deployment of service",
        "input_parameters": [
          {
            "name": "team_number",
            "label": "Team Number",
            "customtype": "string",
            "type": "string",
            "immutable": false,
            "hidden": false,
            "required": true,
            "secured": false,
            "description": "The number your team was allocated"
          },
          {
            "name": "ssh_password",
            "label": "",
            "customtype": "string",
            "type": "string",
            "immutable": true,
            "hidden": true,
            "required": false,
            "secured": false,
            "description": "",
            "default": "Passw0rd!"
          },
          {
            "name": "CPUs",
            "label": "",
            "customtype": "string",
            "type": "string",
            "immutable": true,
            "hidden": true,
            "required": false,
            "secured": false,
            "description": "",
            "default": "1"
          },
          {
            "name": "RAM",
            "label": "",
            "customtype": "string",
            "type": "string",
            "immutable": true,
            "hidden": true,
            "required": false,
            "secured": false,
            "description": "",
            "default": "1024"
          }
        ],
        "flow": {
          "conditions": [],
          "templates": [
            {
              "CAMLAB3.7 Terraform Project": {
                "title": "CAMLAB3.7 Terraform Project_a44db4",
                "template_name": "CAMLAB3.7 Terraform Project",
                "version": "master",
                "id": "camlab37472856c2",
                "template_type": "Terraform",
                "template_content_type": "VMware vSphere",
                "template_provider": "VMware vSphere",
                "instance_name": "",
                "cloud_connection_name": "Team7_VMware",
                "template_data_objects": {},
                "template_params": {
                  "vsphere_server": "10.0.0.210",
                  "allow_unverified_ssl": "true",
                  "vsphere_datacenter": "Datacenter",
                  "vsphere_cluster": "DatacenterCluster",
                  "vsphere_resource_pool": "CAMPool",
                  "datastore_cluster": "DatastoreCluster",
                  "folder": "Target/Team",
                  "team_number": "${input_parameters.team_number}",
                  "network_label": "VM Network",
                  "template": "rhels76-template",
                  "instance_name": "newlab3vm",
                  "domain": "camlab.local",
                  "staticipblock": "10.0.0.0/24",
                  "staticipblock_offset": "90",
                  "gateway": "10.0.0.254",
                  "netmask": "0",
                  "dns_servers": [
                    "10.0.0.254",
                    "10.0.0.253"
                  ],
                  "nodes": "1",
                  "vcpu": "${input_parameters.CPUs}",
                  "memory": "${input_parameters.RAM}",
                  "disk_size": "50",
                  "thin_provisioned": "true",
                  "eagerly_scrub": "false",
                  "keep_disk_on_remove": "false",
                  "ssh_user": "root",
                  "ssh_password": "${input_parameters.ssh_password}"
                },
                "outputs": []
              }
            }
          ],
          "resthooks": [
            {
              "resthook": {
                "title": "resthook_638291",
                "id": "resthook885c331b",
                "headers": {
                  "accept": "application/json",
                  "Content-Type": "application/json"
                },
                "url": "https://gitlab.10.10.1.4.nip.io/api/v4/projects/6/issues?private_token=qPxeBhNNY4s888UW6hFV",
                "method": "POST",
                "payload": {
                  "title": "Team ${input_parameters.team_number} has provisioned a new virtual machine",
                  "description": "You are able to see your system in the CAM Console at https://10.10.1.2:30000/cam/portal/#!/serviceDetails/${svc_instance.service_instance_id} - Instance name ${svc_instance.name}"
                }
              }
            }
          ],
          "notifications": [],
          "sequence": {
            "0": "camlab37472856c2",
            "1": "resthook885c331b"
          },
          "error_sequence": {}
        },
        "output_parameters": []
      }
    ],
    "plans": [
      {
        "name": "Small-Configuration",
        "description": "RedHat Linux VM with 2 GB RAM and 2 vCPUs",
        "plan_parameters": [
          {
            "name": "CPUs",
            "label": "",
            "customtype": "string",
            "type": "string",
            "immutable": true,
            "hidden": true,
            "required": false,
            "secured": false,
            "description": "",
            "default": "2"
          },
          {
            "name": "RAM",
            "label": "",
            "customtype": "string",
            "type": "string",
            "immutable": true,
            "hidden": true,
            "required": false,
            "secured": false,
            "description": "",
            "default": "2048"
          }
        ]
      },
      {
        "name": "Medium-Configuration",
        "description": "RedHat Linux VM with 4 GB RAM and 4 vCPUs",
        "plan_parameters": [
          {
            "name": "RAM",
            "label": "",
            "customtype": "string",
            "type": "string",
            "immutable": true,
            "hidden": true,
            "required": false,
            "secured": false,
            "description": "",
            "default": "4096"
          },
          {
            "name": "CPUs",
            "label": "",
            "customtype": "string",
            "type": "string",
            "immutable": true,
            "hidden": true,
            "required": false,
            "secured": false,
            "description": "",
            "default": "4"
          }
        ]
      },
      {
        "name": "Large-Configuration",
        "description": "RedHat Linux VM with 8 GB RAM and 4 vCPUs",
        "plan_parameters": [
          {
            "name": "CPUs",
            "label": "",
            "customtype": "string",
            "type": "string",
            "immutable": true,
            "hidden": true,
            "required": false,
            "secured": false,
            "description": "",
            "default": "4"
          },
          {
            "name": "RAM",
            "label": "",
            "customtype": "string",
            "type": "string",
            "immutable": true,
            "hidden": true,
            "required": false,
            "secured": false,
            "description": "",
            "default": "8192"
          }
        ]
      }
    ]
  }
}
